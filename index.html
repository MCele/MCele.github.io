<!DOCTYPE html>
<html>
    <head>
        <title> The Island </title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script type="text/javascript" src="js/phaser.min.js"></script>

    </head>
    <body>
	<script type="text/javascript">
		var game = new Phaser.Game(1150, 650, Phaser.AUTO, '', { preload: preload, create: create, update: update });
    var i;
		function preload() {
			        game.load.image('bosq', 'assets/fondo.jpg');
			        game.load.spritesheet('john', 'assets/john.png', 107, 205);
		          game.load.spritesheet('dragon', 'assets/dragon5.png', 207, 300);
              game.load.image('cereza', 'assets/cereza.png');
              game.load.image('platf1', 'assets/plataforma1.png');
              game.load.image('platf2', 'assets/plataforma2.png');
              game.load.image('platf3', 'assets/plataforma3.png');
              game.load.spritesheet('planta_c','assets/planta_carnivora.png',78,152);
              game.load.spritesheet('abeja','assets/abeja.png',88.4,101);
		}

		function create() {
                    game.physics.startSystem(Phaser.Physics.ARCADE);
                    //  A simple background for our game
                    // fondo
                    fondo=game.add.sprite(0, 0, 'bosq');
                    fondo.scale.setTo(1.2,1.2);
                    //plataformas
                    //p1=game.add.sprite(210,450, 'platf1');
                    //p2=game.add.sprite(440,350, 'platf2');
                    //p3=game.add.sprite(710,450, 'platf3');
                    //p4=game.add.sprite(610,200, 'platf3');
                    //p1.scale.setTo(1.2,1.2);
                    plataformas = game.add.group();
                    plataformas.enableBody = true;
                    var p1 = plataformas.create(210, 450, 'platf1');
                    var p2 = plataformas.create(440, 350, 'platf2');
                    var p3 = plataformas.create(710, 450, 'platf3');
                    var p4 = plataformas.create(610, 200, 'platf3');
                    p1.body.immovable = true;
                    p2.body.immovable = true;
                    p3.body.immovable = true;
                    p4.body.immovable = true;

                    // frutas
                    fruta=game.add.sprite(260,422,'cereza');
                    fruta.scale.setTo(0.2,0.2);
                    // planta carnivora
                    planta_c = game.add.sprite(780,380,'planta_c');
                    planta_c.scale.setTo(0.7,0.7);
                    game.physics.arcade.enable(planta_c);
                    planta_c.animations.add('comer', [0, 1, 2, 1, 0], 4, true);
                    // dragon
                    /*dragon = game.add.sprite(60, 20, 'dragon');
                    game.physics.arcade.enable(dragon);
                    dragon.animations.add('volar', [16, 17, 18, 19, 20, 21, 22, 23], 4, true);
                    dragon.animations.add('caminar', [30, 31, 32, 33, 34], 4, true);
                    dragon.animations.add('saltar', [24, 25, 26, 27, 28, 29], 5, true);
                    dragon.animations.add('saltoVuelo', [ 1, 2, 3, 5, 25, 5], 4, false,true);
                    dragon.animations.add('bajarVuelo', [26, 27, 28, 29], 4, false,true);
                    dragon.animations.add('atacar', [4, 5, 6, 7, 8, 9, 10], 4, true);
                    dragon.animations.add('estar', [0, 1, 2, 3, 2, 34, 33, 32, 33], 4, false);
                    */
                    // john
                    john = game.add.sprite(200, 550, 'john');
                    john.scale.setTo(0.4,0.4);
                    game.physics.arcade.enable(john);
                    john.animations.add('derecha', [0, 1, 2, 3, 4,3,2,1], 7, true);
                    john.animations.add('izquierda', [8, 9, 10, 11, 12, 13], 4, true);
                    john.animations.add('saltar', [13,14,15,16], 4,true);
                    john.body.gravity.y = 80;
                    john.body.collideWorldBounds = true;
                    //dragon.animations.add('bajarVuelo', [26, 27, 28, 29], 4, false,true);
                    //dragon.animations.add('atacar', [4, 5, 6, 7, 8, 9, 10], 4, true);
                    //dragon.animations.add('estar', [0, 1, 2, 3, 2, 34, 33, 32, 33], 4, false);
                    jumpButton = game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);
                    // abeja
                    abeja = game.add.sprite(70, 530, 'abeja');
                    abeja.animations.add('volar',[0,1,2,3,4,5,6],4,true);
                    abeja.scale.setTo(0.6,0.6);
                    game.physics.arcade.enable(abeja);

                    cursors = game.input.keyboard.createCursorKeys();//para habilitar las flechas
		}

		function update() {
            game.physics.arcade.collide(plataformas,john);
                    planta_c.body.velocity.x = 0;
                    planta_c.body.velocity.y = 0;
                    abeja.body.velocity.x = 1;
                    abeja.body.velocity.y = 0;
                    console.log(john);
                    //console.log(dragon);
                    console.log(planta_c);
                    //dragon.animations.play('volar');
                    abeja.animations.play('volar');
                    abeja.body.velocity.x = 20;
                    planta_c.animations.play('comer');
                    if (cursors.right.isDown){
                        john.animations.play('derecha');
                        john.body.velocity.x = 40;
                        john.body.velocity.y = 0;
                    } else if(cursors.up.isDown){
                        john.animations.play('saltar');
                        john.body.velocity.y = -100;
                    } else if(cursors.left.isDown){
                        john.body.velocity.x = -40;
                    }
                }
	</script>
    </body>
</html>
